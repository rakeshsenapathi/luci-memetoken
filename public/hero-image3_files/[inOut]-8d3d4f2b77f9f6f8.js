(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5285],{84914:function(e,t,r){"use strict";var n=r(93981),i=r(42754),a=r(81423),s=r(91511),o=r(11711),l=r(29541);r(11805);t.ZP=function(e){var t=e.children,r=(0,o.NL)(),c=(0,n.useState)((function(){return s.d.createClient({transformer:i.ZP,links:[(0,a.N8)({url:"".concat("","/api/trpc")})]})}))[0];return(0,l.jsx)(s.d.Provider,{client:c,queryClient:r,children:t})}},34522:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSG:function(){return Ee},default:function(){return Ke}});var n=r(68586),i=r(63956),a=r(70107),s=r(97620),o=r(27195),l=r(8857),c=r.n(l),u=r(73360),d=r(7761),m=r(26174),f=r(23112),x=r(7744),p=r(65558),h=r.n(p),v=r(91551),b=r.n(v),g=r(13838),j=r(93981),y=r(13215),w=r(72215),k=r(27177),P=r(13170),N=r(63277),C=r(42082),O=r(22466),Z=r(29541),I={decimals:6,address:"",chainId:101,name:"",symbol:""},M=(0,j.createContext)(null),T=function(){var e=(0,j.useContext)(M);if(!e)throw new Error("useLimitOrderUi must be used within LimitOrderProvider");return e},F=function(e){var t,r,n=e.fromPairTokenInfo,i=e.toPairTokenInfo,a=e.children,o=(0,C.T)(),l=(0,O.V)(),c=(0,s.Z)(l,2),u=c[0],d=c[1],m=(0,w.gZ)().fetchTokenAccounts;(0,j.useEffect)((function(){u&&d&&m([u.address,d.address])}),[u,d,m]);var f=(0,j.useCallback)((function(e,t){o(e,t)}),[o]);return(0,Z.jsx)(M.Provider,{value:{onPairChange:f,fromPairTokenInfo:null!==(t=null!==n&&void 0!==n?n:u)&&void 0!==t?t:I,toPairTokenInfo:null!==(r=null!==i&&void 0!==i?i:d)&&void 0!==r?r:I},children:a})},S=r(6691),V=r(66956),B=r(25546),A=r(40993),D=r(25224),L=r(75206),H=r(3011),_=r(39268),E=r.n(_),K=r(72997),R=r(72282),q=r(90342),W=r(33130),U=r(11003),G=r(85394),Q=r(59394),z=r(78013),Y=r(11823),J=r(56720),X=r(64508),$=r.n(X),ee=r(78232),te=r(41118),re=r(77798),ne=r(23632),ie=r(68718),ae=r(55948),se=r(51633),oe=r(24201),le=r(54566),ce=r(70006),ue=r(71130),de=r(37124),me=r(30610),fe=r(56100),xe=r(60012),pe=r(96404),he=r(69825),ve=r(95523),be=r(3561),ge=r(12939),je=function(e){return Object.entries(e).reduce((function(e,t){var r=(0,s.Z)(t,2),n=r[0],i=r[1];return"hour"===n?e+=60*i*60:"minute"===n&&(e+=60*i),e}),0)},ye=function(e){var t=e.onSet,r=e.value,n="number"===typeof r?(0,B.K3)(Number(r)):{day:0,hour:0,minute:0},i=n.day,a=n.hour,s=n.minute,o=(0,y.cI)({defaultValues:{hour:(24*i+a).toString(),minute:s.toString()}}),l=o.control,c=o.handleSubmit,d=(0,o.watch)(),m=(0,j.useMemo)((function(){return!d.hour&&!d.minute||0===Number(d.hour)&&0===Number(d.minute)||je(d)>31536e4}),[d.hour,d.minute]),f=(0,j.useCallback)((function(e){var r=je(e);t(String(r))}),[t]),x=(0,j.useRef)(),p=(0,j.useRef)(),h=(0,j.useCallback)((function(){var e;return null===x||void 0===x||null===(e=x.current)||void 0===e?void 0:e.focus()}),[]),v=(0,j.useCallback)((function(){var e;return null===p||void 0===p||null===(e=p.current)||void 0===e?void 0:e.focus()}),[]);return(0,Z.jsx)("div",{className:"w-full flex justify-center",children:(0,Z.jsxs)("form",{className:"p-3 bg-white dark:bg-tuna flex flex-col space-y-3 rounded-xl w-[320px] shadow-lg",onSubmit:c(f),children:[(0,Z.jsx)("div",{className:"text-base leading-8 font-semibold",children:(0,Z.jsx)(u.cC,{id:"Custom Expiry Period"})}),(0,Z.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,Z.jsxs)("div",{onClick:h,className:"flex w-full items-center justify-between bg-jupiter-input-light dark:bg-jupiter-input-dark p-4 rounded-xl ",children:[(0,Z.jsx)(y.Qr,{control:l,name:"hour",render:function(e){var t=e.field,r=t.onChange,n=t.value,i=t.name;return(0,Z.jsx)(he.Z,{name:i,className:"!text-left !text-sm placeholder:text-black/20 dark:placeholder:text-white/20",placeholder:"0",decimals:0,onChange:function(e){return r(e.value)},value:"0"===n?"":n,ref:x})}}),(0,Z.jsx)("div",{className:"text-sm text-black/20 dark:text-white/20",children:(0,Z.jsx)(u.cC,{id:"Hours"})})]}),(0,Z.jsxs)("div",{onClick:v,className:"flex w-full items-center justify-between bg-jupiter-input-light dark:bg-jupiter-input-dark p-4 rounded-xl",children:[(0,Z.jsx)(y.Qr,{control:l,name:"minute",render:function(e){var t=e.field,r=t.onChange,n=t.value,i=t.name;return(0,Z.jsx)(he.Z,{name:i,className:"!text-left !text-sm placeholder:text-black/20 dark:placeholder:text-white/20",placeholder:"0",decimals:0,onChange:function(e){return r(e.value)},value:"0"===n?"":n,ref:p})}}),(0,Z.jsx)("div",{className:"text-sm text-black/20 dark:text-white/20",children:(0,Z.jsx)(u.cC,{id:"Minutes"})})]})]}),(0,Z.jsx)("button",{type:"submit",disabled:m,className:"font-semibold w-full mt-2 bg-jupiter-navy dark:bg-jupiter-gradient text-white rounded-lg items-center p-px disabled:cursor-not-allowed disabled:opacity-50",children:(0,Z.jsx)("div",{className:"flex items-center justify-center px-8 py-4 rounded-lg dark:bg-black",children:(0,Z.jsx)("span",{className:"text-center",children:(0,Z.jsx)(ge.Z,{animate:!1,children:(0,Z.jsx)(u.cC,{id:"Set Period"})})})})})]})})},we=r(46267),ke=r(59243),Pe=r(33118),Ne=function(e){var t=e.fromPairTokenInfo,r=e.toPairTokenInfo,n=e.baseTokenInfo,i=e.quoteTokenInfo,s=e.baseTokenPrice,l=e.quoteTokenPrice,m=e.baseAndQuoteTokenPriceFetched,f=e.rateDecimals,x=e.control,p=e.isDisabled,h=e.onSubmit,v=e.setValue,b=e.watchAllFields,k=e.formState,N=e.isLoadingDasQuery,C=e.tokenHaveTransferFee,O=e.customDateLabel,I=e.setCustomDate,M=(0,ce.JT)(),F=M.openContextualModal,S=M.ModalContextConsumer,V=M.closeModal,A=M.openModal,L=(0,w.Os)().wallet,H=T().onPairChange,_=(0,j.createRef)(),E=(0,w.Bn)(),K=E.tokenMap,R=E.newTokenListMap,q=(0,j.useState)(!1),W=q[0],U=q[1],Q=(0,j.useState)(!1),z=Q[0],X=Q[1],ge=(0,j.useMemo)((function(){if(!te.d.find((function(e){return e===(null===t||void 0===t?void 0:t.address)||e===(null===r||void 0===r?void 0:r.address)})))return null;var e=b.fromPair===(null===n||void 0===n?void 0:n.address);return{isFromBase:Boolean(e)}}),[null===n||void 0===n?void 0:n.address,null===t||void 0===t?void 0:t.address,null===r||void 0===r?void 0:r.address,b.fromPair]),je=j.useCallback((function(e){var n=e,i=r;r.address===e.address&&(n=r,i=t),X(!1),i&&H(n,i)}),[H,t,r]),Ne=j.useCallback((function(e){var n=t,i=e;t.address===e.address&&(n=r,i=t),X(!1),n&&H(n,i)}),[H,t,r]),Ce=j.useCallback((function(){H(r,t),v("fromPairValue","1"),X(!1)}),[r,t,H,v]),Oe=(0,j.useMemo)((function(){return(0,D.Hd)(b.targetPrice)?Number(b.targetPrice):0}),[b.targetPrice]),Ze=j.useCallback((function(e){(0,D.Hd)(e)&&v("toPairValue",e)}),[v]),Ie=(0,re.E)(),Me=(0,ne.s)({quoteTokenInfo:i,baseTokenInfo:n,quoteTokenPrice:l,baseTokenPrice:s,isBaseQuoteMode:ge,rateDecimals:f,isSubmitting:k.isSubmitting}),Te=Me.swapMarketPrice,Fe=Me.lastMarketPrice,Se=Me.isFetching,Ve=Boolean(s&&l&&Fe),Be=(0,j.useCallback)((function(e){Te&&Ve&&(v("targetPrice",Te.toFixed()),Ze(null!==ge&&void 0!==ge&&ge.isFromBase?new g.Z(Te.toFixed()).mul(e||0).toDP(f).toFixed():new g.Z(e||0).div(Te).toDP(f).toFixed()))}),[Te,Ve,v,Ze,ge,f]),Ae=(0,j.useMemo)((function(){return R.has(i.address)||R.has(n.address)}),[R,i,n]);(0,j.useEffect)((function(){z||(v("targetPrice",""),v("toPairValue",""),Ae||Be(b.fromPairValue))}),[z,Be,Ae]);var De=(0,j.useMemo)((function(){var e=new g.Z(0);if(!Ve||!b.targetPrice||!Fe)return e;var t=new g.Z(Oe).sub(Fe).div(Fe);return(e=new g.Z(100).mul(t).toDP(2)).isFinite()?e:new g.Z(0)}),[b.targetPrice,Fe,Oe,Ve]),Le=(0,j.useMemo)((function(){return De.gt(1e4)?">10000":"".concat(De.toNumber()>0?"+":"").concat(De.toDP(2).toString())}),[De]),He=(0,j.useMemo)((function(){return null!==ge&&void 0!==ge&&ge.isFromBase?De.toNumber()<0:De.toNumber()>0}),[null===ge||void 0===ge?void 0:ge.isFromBase,De]),_e=(0,j.useMemo)((function(){return null!==ge&&void 0!==ge&&ge.isFromBase?De.toNumber()>0:De.toNumber()<0}),[null===ge||void 0===ge?void 0:ge.isFromBase,De]),Ee=(0,j.useMemo)((function(){return!Se&&(He||_e)}),[He,_e,Se]),Ke=(0,j.useMemo)((function(){return null!==ge&&void 0!==ge&&ge.isFromBase?De.toNumber()>-5:De.toNumber()<5}),[null===ge||void 0===ge?void 0:ge.isFromBase,De]),Re=(0,w.y6)().tokenPriceMap,qe=(0,j.useMemo)((function(){return!Ve&&!Se&&m}),[m,Ve,Se]),We=(0,j.useMemo)((function(){if(Ie){if(Ae)return(0,Z.jsx)(u.cC,{id:"Due to the new token's high volatility during its price discovery phase, exercise caution when trading. We recommend setting a specific price before placing an order."});if(qe)return(0,Z.jsx)(u.cC,{id:"Could not retrieve market price for this pair. Trade with caution"});var e=(0,Z.jsx)($(),{shallow:!0,href:"/swap/".concat(t.symbol,"-").concat(r.symbol,"?inAmount=").concat(b.fromPairValue),className:"underline font-bold",target:"_blank",children:(0,Z.jsx)(u.cC,{id:"Jupiter Swap"})}),n=(0,Z.jsx)(u.cC,{id:"Limit price is {0}% {1} than market, you are {2} at a much {3} rate. We recommend that you use {swapLink} instead",values:{0:De.absoluteValue(),1:null!==ge&&void 0!==ge&&ge.isFromBase?"lower":"higher",2:null!==ge&&void 0!==ge&&ge.isFromBase?"selling":"buying",3:null!==ge&&void 0!==ge&&ge.isFromBase?"lower":"higher",swapLink:e}});if(null!==ge&&void 0!==ge&&ge.isFromBase){if(De.toNumber()<=-.5)return n}else if(De.toNumber()>=.5)return n}}),[Ie,Ae,qe,t.symbol,r.symbol,b.fromPairValue,De,null===ge||void 0===ge?void 0:ge.isFromBase]),Ue=(0,w.FB)(b.fromPair).balance,Ge=j.useCallback((function(e){var t;e.preventDefault(),t=b.fromPair===P.W4.toBase58()?new g.Z(Ue).gt(J.WO)?new g.Z(Ue).minus(J.WO).toString():"0":String(Ue),v("fromPairValue",t);var r=null!==ge&&void 0!==ge&&ge.isFromBase?Oe:Oe?1/Oe:0;v("toPairValue",new g.Z(t).mul(r).toFixed())}),[b.fromPair,v,null===ge||void 0===ge?void 0:ge.isFromBase,Oe,Ue]),Qe=(0,j.useMemo)((function(){if(null===L||void 0===L||!L.adapter.connected)return!1;if((null===t||void 0===t?void 0:t.address)!==P.W4.toBase58())return!1;if(!(0,D.Hd)(b.fromPairValue))return!1;var e=new g.Z(Ue).minus(J.WO);return new g.Z(b.fromPairValue||0).gt(e)}),[null===t||void 0===t?void 0:t.address,Ue,null===L||void 0===L?void 0:L.adapter.connected,b.fromPairValue]),ze=(0,j.useMemo)((function(){return new g.Z(b.fromPairValue||0).lte(Ue)}),[Ue,b.fromPairValue]),Ye=(0,xe.useIsAccountFrozen)(t),Je=(0,xe.useIsAccountFrozen)(r),Xe=(0,j.useCallback)((function(){S&&F(ke.YN,void 0,(0,Z.jsx)(S,{children:function(){var e,t;return(0,Z.jsx)(ye,{onSet:function(e){v("expiry",e),I((0,B.K3)(Number(e))),V()},value:null!==(e=null===(t=ke.yn[b.expiry])||void 0===t?void 0:t.name)&&void 0!==e?e:Number(b.expiry)})}}),{position:"center",containerStyle:{background:"none",boxShadow:"none"}})}),[S,b.expiry,F,v,V,I]),$e=(0,ie.Z)({tokens:[]}),et=(0,j.useCallback)(function(){var e=(0,o.Z)(c().mark((function e(n){var i,a,s,o,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),i=b.fromPairValue,a=b.targetPrice,s=b.toPairValue,o=i?new g.Z(i).mul(a):null,l=new g.Z(i).div(s).toString(),A((0,Z.jsx)(ee.Z,{quotedRate:l,onConfirm:h,inputAmount:i,outputAmount:s,inputPair:t,outputPair:r,usdRate:o}),{onClose:function(){},containerStyle:{borderRadius:"12px"}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,h,A,r,b]),tt=(0,j.useMemo)((function(){var e=[];if(function(){var r,n=null===(r=Re[t.address||""])||void 0===r?void 0:r.usd,i=new g.Z(b.fromPairValue||0).mul(n||0);i&&i.mul(1.001).lt(te.u)&&e.push(d.ag._("Order must meet a minimum of {MINIMUM_LIMIT_ORDER} USD",{MINIMUM_LIMIT_ORDER:te.u}))}(),(null===C||void 0===C?void 0:C.length)>0){var r=[d.ag._("Token2022 tokens with transfer fee extensions enabled will result in repetitive fees (and can be updated anytime),  please trade other tokens.")].concat((0,a.Z)(C.map((function(e){return(0,Z.jsxs)("p",{className:"mt-1",children:["- ",e.symbol," (",e.fee,"%)"]},e.address)}))));e.push(r)}return e}),[t.address,C,Re,b.fromPairValue]),rt=(0,j.useMemo)((function(){return p||!ze||Qe||!Ke||Ye||Je||N||tt.length>0}),[tt.length,ze,p,Ye,Je,N,Qe,Ke]);return(0,Z.jsxs)("form",{className:"flex flex-col space-y-2 justify-center w-full h-auto",onSubmit:qe?et:h,children:[(0,Z.jsxs)("div",{children:[(0,Z.jsxs)("div",{className:(0,oe.cn)("min-h-[124px] flex flex-col space-y-3 p-4 border border-transparent rounded-xl bg-uiv2 group","focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:[(0,Z.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Z.jsx)("span",{className:"text-sm font-medium text-v2-lily",children:(0,Z.jsx)(u.cC,{id:"You're Selling"})}),(0,Z.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Z.jsx)("div",{className:"fill-current text-white-75",children:(0,Z.jsx)(se.Z,{width:12,height:12})}),t.address?(0,Z.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Z.jsxs)("div",{className:"flex items-center space-x-1 cursor-pointer hover:text-v2-lily text-xs font-normal text-v2-lily/50 whitespace-nowrap",onClick:Ge,children:[(0,Z.jsx)(pe.Z,{mintAddress:t.address}),(0,Z.jsx)("span",{children:t.symbol})]}),(0,Z.jsx)(Y.oi,{mint:t.address,onBalanceChange:function(e){v("fromPairValue",e.toString());var t=null!==ge&&void 0!==ge&&ge.isFromBase?Oe:Oe?1/Oe:0;v("toPairValue",new g.Z(e).mul(t).toFixed())}})]}):(0,Z.jsx)("span",{children:"0.00"})]})]}),(0,Z.jsx)(we.Z,{testId:"fromPair",pair:t,pairName:"fromPairValue",disabled:!1,control:x,onSubmit:je,mintsList:Array.from(K.keys()),modalId:ke.r$,watchAllFields:b,onChangeCalculate:function(e){var t=(0,D.Hd)(e)?e:0,n=null!==ge&&void 0!==ge&&ge.isFromBase?Oe:Oe?1/Oe:0;v("fromPairValue",t||""),v("toPairValue",new g.Z(t).mul(n).toDP(r.decimals).toFixed())},className:"flex-1"})]}),(0,Z.jsx)(xe.default,{tokenInfo:t,className:"mt-2"}),Qe?(0,Z.jsx)(ue.Z,{className:"mt-2 !px-2 !text-xs !font-normal !text-v2-lily",message:d.ag._("We recommend having at least {MINIMUM_SOL_BALANCE} SOL for any transaction",{MINIMUM_SOL_BALANCE:J.WO}),iconSize:16}):null,(0,Z.jsxs)("div",{className:"relative flex justify-center my-1",children:[(0,Z.jsx)("hr",{className:"absolute w-full border-uiv2/50 top-[calc(50%-1px)] -z-0"}),(0,Z.jsx)("div",{className:"inline-block z-10",children:(0,Z.jsx)("button",{type:"button",className:(0,oe.cn)("group/flip bg-v2-background-page w-8 h-8 rounded-full cursor-pointer flex flex-col justify-center border-[3px] border-uiv2 text-v2-lily/50","dark:hover:border-v2-primary dark:hover:shadow-swap-input-dark"),onClick:Ce,children:(0,Z.jsx)("span",{className:"w-full text-v2-lily/50 fill-current flex justify-center transition-none group-hover/flip:text-v2-primary/50 dark:group-hover/flip:text-v2-primary",children:(0,Z.jsx)(ve.Z,{})})})})]}),(0,Z.jsx)("div",{className:"border-b border-transparent",children:(0,Z.jsxs)("div",{className:(0,oe.cn)("min-h-[124px] flex flex-col space-y-2 p-4 border border-transparent rounded-lg bg-uiv2 group","focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:[(0,Z.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Z.jsx)("span",{className:"text-sm font-medium text-v2-lily",children:(0,Z.jsx)(u.cC,{id:"You're Buying"})}),(0,Z.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Z.jsx)("div",{className:"fill-current text-white-75",children:(0,Z.jsx)(se.Z,{width:12,height:12})}),r.address?(0,Z.jsxs)("div",{className:"flex items-center cursor-pointer dark:hover:text-v2-lily text-xs font-normal text-v2-lily/50 whitespace-nowrap",children:[(0,Z.jsx)(pe.Z,{mintAddress:r.address}),(0,Z.jsx)("span",{className:"ml-1",children:r.symbol})]}):(0,Z.jsx)("span",{children:"0.00"})]})]}),(0,Z.jsx)(we.Z,{testId:"toPair",pair:r,pairName:"toPairValue",control:x,onSubmit:Ne,mintsList:Array.from(K.keys()),modalId:ke.re,watchAllFields:b,onChangeCalculate:function(e){var t=(0,D.Hd)(e)?e:0,r=null!==ge&&void 0!==ge&&ge.isFromBase?Oe:Oe?1/Oe:0;v("toPairValue",0===t?"":t),v("fromPairValue",0===t?"0":new g.Z(t).div(r).toFixed())},className:"flex-1"})]})}),(0,Z.jsx)(xe.default,{tokenInfo:r,className:"mt-2 !-mb-2"})]}),(0,Z.jsxs)("div",{className:"sm:space-x-2 space-y-2 sm:space-y-0 flex-col-reverse sm:flex sm:flex-row mb-2",children:[(0,Z.jsxs)("div",{className:(0,oe.cn)("w-full sm:w-[65%] bg-uiv2 space-y-1 p-4 rounded-lg flex flex-col justify-center !h-[90px]","border border-transparent focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:[(0,Z.jsxs)("div",{className:"flex justify-between",children:[(0,Z.jsxs)("div",{className:"flex items-center",children:[n?(0,Z.jsxs)("div",{className:"flex items-center text-xs font-medium text-v2-lily/50",children:[null!==ge&&void 0!==ge&&ge.isFromBase?(0,Z.jsx)(u.cC,{id:"Sell"}):(0,Z.jsx)(u.cC,{id:"Buy"})," ",(0,Z.jsx)(u.cC,{id:"{0} at rate",values:{0:null===n||void 0===n?void 0:n.symbol}}),Se?(0,Z.jsx)(G.Z,{className:"ml-1",width:8,height:8}):null]}):(0,Z.jsx)(fe.O,{className:"h-4 w-2"}),Ee?(0,Z.jsx)("div",{className:(0,oe.cn)("flex items-center text-xs ml-1 font-medium",{"text-jupiter-yellow":He,"text-v2-primary":_e}),children:"(".concat(Le,"%)")}):null]}),Ve?(0,Z.jsx)("button",{type:"button",className:"text-v2-lily/30 hover:text-v2-lily text-xxs font-semibold cursor-pointer underline rounded",onClick:function(){return Be(b.fromPairValue)},children:(0,Z.jsx)(u.cC,{id:"Use Market"})}):null]}),(0,Z.jsx)(y.Qr,{name:"targetPrice",control:x,render:function(e){var t=e.field,r=t.onChange,n=t.value;return(0,Z.jsxs)("div",{children:[(0,Z.jsxs)("div",{className:"flex items-end",children:[(0,Z.jsx)(he.Z,{testId:"targetPrice",decimals:f,onChangeWithoutEffect:function(e){(0,D.Hd)(e)&&Ze(null!==ge&&void 0!==ge&&ge.isFromBase?new g.Z(e).mul(b.fromPairValue||0).toDP(f).toFixed():new g.Z(b.fromPairValue||0).div(e).toDP(f).toFixed()),r(e)},onFocus:function(){return X(!0)},value:n,disabled:!1,ref:_,className:"!text-left !text-sm !font-semibold !text-v2-lily flex-1 !outline-none"}),i?(0,Z.jsx)("div",{className:"flex items-center",children:(0,Z.jsx)("span",{className:"text-sm font-semibold text-v2-lily",children:null===i||void 0===i?void 0:i.symbol})}):(0,Z.jsx)(fe.O,{className:"w-11 h-6"})]}),i&&(0,Z.jsx)("div",{className:"text-xs text-v2-lily/30",children:(0,Z.jsx)(le.default,{prefix:"\u2248 ",tokenInfo:i,amount:Number(n),maxDecimals:6})})]})}})]}),(0,Z.jsxs)("div",{className:(0,oe.cn)("w-full sm:w-[35%] bg-uiv2 space-y-1 p-4 rounded-lg flex flex-col","border border-transparent focus-within:border-v2-primary/50 focus-within:shadow-swap-input-dark"),children:[(0,Z.jsx)("p",{className:"text-xs font-medium text-v2-lily/50",children:(0,Z.jsx)(u.cC,{id:"Expiry"})}),(0,Z.jsx)(y.Qr,{name:"expiry",control:x,render:function(e){var t,r,n=e.field,i=n.onChange,a=n.value;return(0,Z.jsx)(me.Z,{isOpen:W,onClose:function(){return U(!1)},id:"settings-button",placement:"bottom-end",matchWidth:!0,buttonContentClassName:"h-full",buttonContent:(0,Z.jsxs)("button",{type:"button",onClick:function(){return U((function(e){return!e}))},className:"flex justify-between items-center space-x-2 rounded-lg text-left whitespace-nowrap w-full h-full",children:[(0,Z.jsx)("span",{className:"leading-[1.5] text-sm font-semibold text-v2-lily text-clip overflow-hidden flex-1",children:null!==(t=null===(r=ke.yn[a])||void 0===r?void 0:r.name)&&void 0!==t?t:O}),(0,Z.jsx)("span",{className:"w-3 h-3 flex items-center fill-current text-v2-lily/25",children:(0,Z.jsx)(ae.Z,{})})]}),popoverContent:(0,Z.jsxs)("div",{className:"mt-1 bg-jupiter-light rounded-lg dark:bg-white/10 overflow-hidden text-left whitespace-nowrap",children:[(0,Z.jsx)("div",{className:"max-h-52 overflow-y-auto",children:Object.keys(ke.yn).map((function(e,t){return(0,Z.jsx)("button",{type:"button",onClick:function(){i(e),U(!1)},className:"first:pt-3 last:pb-3 w-full flex items-center py-2 pl-4 pr-3 space-x-2 hover:bg-porcelain dark:hover:bg-shark",children:(0,Z.jsx)("span",{className:"text-xs leading-[1.5] font-medium",children:ke.yn[e].name})},e)}))}),(0,Z.jsx)("button",{className:"mt-1 py-2 pl-4 pr-3 text-left border-t border-t-white-10 text-xs leading-[1.5] font-medium cursor-pointer hover:bg-porcelain dark:hover:bg-shark w-full",onClick:function(e){e.preventDefault(),U(!1),Xe()},children:"Custom"})]}),contentClassName:"!bg-transparent !shadow-none z-50 !w-full"})}})]})]}),(0,Z.jsx)("div",{className:(0,oe.cn)("bg-transparent transition-all duration-700 align-bottom",{"opacity-0 h-0":!Boolean(We),"opacity-100":Boolean(We)}),children:We&&(0,Z.jsx)("div",{className:(0,oe.cn)("border-yellow-500 bg-yellow-300/25 rounded-xl px-3 border text-yellow-500 transition-all duration-500 text-xs font-medium align-middle py-2"),children:We})}),tt.length>0?(0,Z.jsxs)("div",{className:"py-3 px-4 rounded-lg text-xs flex items-start text-white space-x-2 w-full bg-[#F04A44]",children:[(0,Z.jsx)("div",{className:"h-3 w-3 mt-0.5 fill-current",children:(0,Z.jsx)(be.Z,{fill:"inherit"})}),(0,Z.jsx)("div",{className:"flex flex-col space-y-1",children:tt.map((function(e,t){return(0,Z.jsx)("div",{children:e},t)}))})]}):null,(0,Z.jsx)("div",{className:"flex",children:null!==L&&void 0!==L&&L.adapter.publicKey?$e?(0,Z.jsx)(ie.y,{}):(0,Z.jsx)(de.Z,{type:"submit",disabled:rt,children:Qe||!ze?(0,Z.jsx)(u.cC,{id:"Insufficient {0}",values:{0:null===t||void 0===t?void 0:t.symbol}}):Ye||Je?(0,Z.jsx)(u.cC,{id:"Token account frozen"}):k.isSubmitting?(0,Z.jsx)(u.cC,{id:"Submitting..."}):(0,Z.jsx)(u.cC,{id:"Place Limit Order"})}):(0,Z.jsx)(Pe.Z,{})})]})},Ce=r(63068),Oe=r(36404),Ze=r(84914),Ie=r(91511),Me=r(45009),Te=r(5564),Fe=r(43723),Se=r(28940),Ve=r(67768),Be=function(e){var t,r,n=e.rateDecimals,i=e.fromPairTokenInfo,a=e.toPairTokenInfo,s=e.fromPairValue,o=e.toPairValue,l=e.expiry,c=e.targetPrice,m=e.feeStructure,f=e.customDateLabel,x=(0,Se.Z)(),p=x.showSummary,h=x.toggleSummary,v=(0,j.useCallback)((function(){return!(!ke.CO.includes(i.address)||!ke.CO.includes(a.address))||(!(!ke.Jx.includes(i.address)||!ke.Jx.includes(a.address))||!(!ke.OC.includes(i.address)&&!ke.OC.includes(a.address)))}),[i.address,a.address]),b=(0,j.useMemo)((function(){return m.data?v()?new g.Z(m.data.stableFeeBps).div(100).toFixed(2)+"%":new g.Z(m.data.normalFeeBps).div(100).toFixed(2)+"%":null}),[m.data,v]),y=(0,j.useMemo)((function(){var e=new g.Z(s||0);return e.eq(0)?"-":Ve.uf.format(e,i.decimals)}),[s,i.decimals]),w=(0,j.useMemo)((function(){var e=new g.Z(o||0);return e.eq(0)?"-":Ve.uf.format(e,a.decimals)}),[o,a.decimals]),k=(0,j.useMemo)((function(){var e=new g.Z(c||0);return e.eq(0)?"-":Ve.uf.format(e,n)}),[c,n]);return(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{className:"flex justify-center items-center mb-4 mt-3",children:(0,Z.jsxs)("button",{type:"button",onClick:h,className:"flex items-center space-x-2 cursor-pointer text-white/25 hover:text-v2-primary",children:[(0,Z.jsx)("div",{className:"h-4 w-4 flex items-center fill-current",children:p?(0,Z.jsx)(Fe.Z,{}):(0,Z.jsx)(ae.Z,{})}),(0,Z.jsx)("span",{className:"text-xs font-medium",children:(0,Z.jsx)(u.cC,{id:"Limit Order Summary"})})]})}),p&&(0,Z.jsx)("div",{className:"w-full p-5 rounded-lg border border-v2-lily/10 text-xs mt-3",children:(0,Z.jsxs)("div",{className:"space-y-1",children:[(0,Z.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,Z.jsx)("div",{className:"text-white-50",children:(0,Z.jsx)(u.cC,{id:"Sell Order"})}),(0,Z.jsxs)("span",{className:"text-white-50",children:[y," ",i.symbol]})]}),(0,Z.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,Z.jsx)("div",{className:"text-white-50",children:(0,Z.jsx)(u.cC,{id:"To Buy"})}),(0,Z.jsxs)("span",{className:"text-white-50",children:[w," ",a.symbol]})]}),(0,Z.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,Z.jsx)("div",{className:"text-white-50",children:(0,Z.jsx)(u.cC,{id:"Buy {0} at Rate",values:{0:a.symbol}})}),(0,Z.jsxs)("span",{className:"text-white-50",children:[k," ",i.symbol]})]}),(0,Z.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,Z.jsx)("div",{className:"text-white-50",children:(0,Z.jsx)(u.cC,{id:"Expiry"})}),(0,Z.jsx)("span",{className:"text-white-50",children:null!==(t=null===(r=ke.yn[l])||void 0===r?void 0:r.name)&&void 0!==t?t:f})]}),(0,Z.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,Z.jsx)("div",{className:"text-white-50",children:(0,Z.jsx)(u.cC,{id:"Platform Fee"})}),(0,Z.jsx)("span",{className:"text-v2-primary font-bold",children:b})]}),(0,Z.jsxs)("div",{className:"py-3 px-4 text-xs bg-black/15 dark:bg-white/5 text-black/75 dark:text-white/75 border border-black/[.15] dark:border-white/[.15] rounded-lg mt-3",children:[(0,Z.jsx)(u.cC,{id:"You will receive exactly what you have specified, minus platform fees."}),(0,Z.jsx)("a",{className:"ml-1 underline cursor-pointer",href:"https://station.jup.ag/guides/limit-order/how-lo-work",target:"_blank",children:d.ag._("Learn more")})]})]})})]})};function Ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}E()((function(){return Promise.resolve().then(r.bind(r,60012))}),{ssr:!1,loadableGenerated:{webpack:function(){return[60012]}}});var Le={decimals:6,address:"",chainId:101,name:"",symbol:""},He=function(){(0,S.Fg)().mode;var e=(0,R.hv)().appDomain,t=(0,w.Os)(),r=t.wallet,n=t.signTransaction,i=t.signAllTransactions,l=t.publicKey,p=(0,w.MG)().constants.CLUSTER,v=(0,w.Bn)().connection,C=(0,k.lm)(),O=C.toast,I=C.close,M=(0,j.useMemo)((function(){return new m.vN(v)}),[v]),F=T(),_=F.fromPairTokenInfo,E=F.toPairTokenInfo,Y=(0,j.useState)("Open Orders"),J=Y[0],X=Y[1],$=(0,j.useState)(0),ee=$[0],te=$[1];(0,j.useEffect)((function(){te(0)}),[J]);var re=(0,Me.a)([(null===l||void 0===l?void 0:l.toString())||""],(0,o.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=2;break}return e.abrupt("return",[]);case 2:return e.t0=Promise,e.next=5,M.getOrders([(0,m.Gt)(l)]);case 5:return e.t1=e.sent,e.next=8,f.AU([(0,m.Gt)(l)],v);case 8:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=12,e.t0.all.call(e.t0,e.t3);case 12:return t=e.sent,e.abrupt("return",t.flat().filter(Boolean));case 14:case"end":return e.stop()}}),e)}))),{enabled:Boolean(l)&&"Open Orders"===J,refetchInterval:!1}),ne=re.data,ie=re.isFetching,ae=re.refetch,se=(0,j.useMemo)((function(){return null!==ne&&void 0!==ne&&ne.length?Math.ceil(ne.length/P.eN):0}),[ne]),oe=(0,j.useMemo)((function(){return ne?ne.sort((function(e,t){return"createdAt"in e.account===!1?1:"createdAt"in t.account===!1?-1:"createdAt"in e.account&&"createdAt"in t.account?t.account.createdAt.sub(e.account.createdAt).toNumber():0})):[]}),[ne]),le=(0,j.useMemo)((function(){return(null===oe||void 0===oe?void 0:oe.slice(ee*P.eN,ee*P.eN+10))||[]}),[ee,oe]),ce=Ie.d.orderWithTradeHistoryWithItemsCount.useQuery({wallet:l?null===l||void 0===l?void 0:l.toString():"",pageIndex:ee},{enabled:Boolean(l)&&"Order History"===J,refetchInterval:!1,refetchOnWindowFocus:!1,keepPreviousData:!0}),ue=ce.data,de=ce.isFetching,me=ce.refetch,fe=(0,j.useMemo)((function(){return null!==ue&&void 0!==ue&&ue.itemsCount?Math.ceil((null===ue||void 0===ue?void 0:ue.itemsCount)/P.eN):0}),[ue]),xe=(0,N.Z0)(p),pe=(0,y.cI)({defaultValues:{fromPair:xe.initialFrom,toPair:xe.initialTo,fromPairValue:"5",targetPrice:"",toPairValue:"",expiry:"Never"}}),he=pe.control,ve=pe.handleSubmit,be=pe.watch,ge=pe.setValue,je=pe.formState,ye=(0,V.b)(_,E),we=ye.quoteTokenInfo,Pe=ye.baseTokenInfo,Ze=ye.quoteTokenPrice,Fe=ye.baseTokenPrice,Se=ye.rateDecimals,Ve=ye.priceFetched;(0,j.useEffect)((function(){ge("fromPair",_.address),ge("toPair",E.address),ge("targetPrice",""),ge("toPairValue","")}),[_,E,ge]);var Ae=be(),He=(0,j.useMemo)((function(){var e=Ae.fromPair,t=Ae.toPair,r=Ae.fromPairValue,n=Ae.targetPrice,i=Ae.toPairValue,a=Ae.expiry;return!e||!t||Number(r)<=0||Number(i)<=0||Number(n)<=0||!a||je.isSubmitting}),[Ae,je.isSubmitting]),_e=(0,j.useState)([]),Ee=_e[0],Ke=_e[1],Re=(0,W.R3)(),qe=(0,H.KO)(A.yz),We=(0,s.Z)(qe,1)[0],Ue=(0,q.gs)().priorityLevel,Ge=(0,Te.D)([_,E]),Qe=Ge.tokensWithTransferFee,ze=Ge.dasQuery,Ye=Ge.isLoadingDasQuery,Je=(0,j.useCallback)(function(){var e=(0,o.Z)(c().mark((function e(t){var s,o,l,m,p,b,j,y,k,P,N,C,O,I,M,T,F,S,V,B,H,K;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!He&&r&&r.adapter.publicKey&&n&&i){e.next=2;break}return e.abrupt("return");case 2:return l=new(h())(new g.Z(t.fromPairValue).mul(Math.pow(10,_.decimals)).round().toString()),m=new(h())(new g.Z(t.toPairValue).mul(Math.pow(10,E.decimals)).round().toString()),p=null!==(s=null===(o=ke.yn[t.expiry])||void 0===o?void 0:o.value)&&void 0!==s?s:Number(t.expiry),b="Never"===t.expiry?null:new(h())((new Date).valueOf()/1e3+p),j=x.PublicKey.default,e.prev=7,N=(0,D.kL)(_)||(null===ze||void 0===ze||null===(y=ze.find((function(e){return(null===e||void 0===e?void 0:e.id)===_.address})))||void 0===y?void 0:y.token_info.token_program)===w.nA.toString()?w.nA:L.TOKEN_PROGRAM_ID,C=(0,D.kL)(E)||(null===ze||void 0===ze||null===(k=ze.find((function(e){return(null===e||void 0===e?void 0:e.id)===E.address})))||void 0===k?void 0:k.token_info.token_program)===w.nA.toString()?w.nA:L.TOKEN_PROGRAM_ID,e.next=12,f.D9({params:{uniqueId:new(h())(Math.round(1e6*Math.random())),makingAmount:l,takingAmount:m,expiredAt:b,feeBps:null},maker:r.adapter.publicKey,payer:r.adapter.publicKey,inputMint:new x.PublicKey(t.fromPair),outputMint:new x.PublicKey(t.toPair),inputTokenProgram:N,outputTokenProgram:C,connection:v,wrapAndUnwrapSol:!0});case 12:return O=e.sent,I=O.ix,M=O.orderPubKey,T=O.cleanupIx,F=O.setupIxs,j=M,Ke((function(e){return[].concat((0,a.Z)(e),[{publicKey:j,account:{oriMakingAmount:l,makingAmount:l,takingAmount:m,oriTakingAmount:m,inputMint:new x.PublicKey(t.fromPair),outputMint:new x.PublicKey(t.toPair),expiredAt:b,createdAt:Date.now()/1e3}}])})),e.next=21,v.getLatestBlockhash("confirmed");case 21:return S=e.sent,V=S.blockhash,B=S.lastValidBlockHeight,H=(P=new x.Transaction({feePayer:r.adapter.publicKey,blockhash:V,lastValidBlockHeight:B})).add.apply(P,(0,a.Z)(F).concat([I])),T&&H.add(T),e.next=28,Re(H,{blockhash:V,lastValidBlockHeight:B,idl:f.xO,idlProgramId:f.Rn,skipPreflight:!0},{successMessage:(0,Z.jsx)(u.cC,{id:"Limit order placed for {0} {1} @ {2} {3}",values:{0:new g.Z(t.fromPairValue).toDP(2).toString(),1:_.symbol,2:new g.Z(t.toPairValue).toDP(E.decimals).toString(),3:E.symbol}}),submittingMessage:(0,Z.jsx)(u.cC,{id:"Placing limit order"}),errorMessage:d.ag._("Failed to create order"),referenceFee:"MEDIUM"===Ue?We.lo.m:"HIGH"===Ue?We.lo.h:"VERY_HIGH"===Ue?We.lo.vh:void 0,minimumFee:A.uo,requestComputeBudgetLimit:3e5});case 28:if(K=e.sent,K.success){e.next=32;break}throw new Error("Failed to create order");case 32:e.next=38;break;case 34:e.prev=34,e.t0=e.catch(7),console.error(e.t0),Ke((function(e){return e.filter((function(e){return e.publicKey.toBase58()!==j.toBase58()}))}));case 38:return e.prev=38,setTimeout((function(){ae()}),1e3),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[7,34,38,41]])})));return function(t){return e.apply(this,arguments)}}(),[He,r,n,i,_,E,ze,v,Re,Ue,We.lo.m,We.lo.h,We.lo.vh,ae]);(0,j.useEffect)((function(){Ke((function(e){return e.filter((function(e){return!Boolean(null===ne||void 0===ne?void 0:ne.find((function(t){return t.publicKey&&e.publicKey.equals(t.publicKey)})))}))}))}),[ne,Ke]);var Xe=(0,j.useCallback)(function(){var e=(0,o.Z)(c().mark((function e(t,r){var n,i,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.cancelOrder({owner:t,orderPubKey:r});case 2:return n=e.sent,e.next=5,v.getLatestBlockhash("confirmed");case 5:return i=e.sent,a=i.blockhash,s=i.lastValidBlockHeight,n.feePayer=t,n.recentBlockhash=a,n.lastValidBlockHeight=s,e.next=13,Re(n,{blockhash:a,lastValidBlockHeight:s,idl:m.xO,idlProgramId:m.zy["mainnet-beta"],skipPreflight:!0},{successMessage:(0,Z.jsx)(u.cC,{id:"Limit order closed"}),submittingMessage:(0,Z.jsx)(u.cC,{id:"Closing limit order"}),errorMessage:(0,Z.jsx)(u.cC,{id:"Failed to close order"}),referenceFee:"MEDIUM"===Ue?We.lo.m:"HIGH"===Ue?We.lo.h:"VERY_HIGH"===Ue?We.lo.vh:void 0});case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[v,Re,M,Ue,We.lo.h,We.lo.m,We.lo.vh]),$e=(0,j.useCallback)(function(){var e=(0,o.Z)(c().mark((function e(t,r){var n,i,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===ne||void 0===ne?void 0:ne.find((function(e){return e.publicKey.equals(r)}))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,f.v4({maker:t,order:n,inputTokenProgram:null===n||void 0===n?void 0:n.account.inputTokenProgram,connection:v});case 5:return i=e.sent,a=i.setupIx,s=i.cancelIx,e.abrupt("return",{setupIx:a,cancelIx:s});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[v,ne]),et=(0,j.useCallback)(function(){var e=(0,o.Z)(c().mark((function e(t,r){var n,i,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getLatestBlockhash("confirmed");case 2:return n=e.sent,i=n.blockhash,a=n.lastValidBlockHeight,s=new x.Transaction({feePayer:t,blockhash:i,lastValidBlockHeight:a}),r.forEach((function(e){e.setupIx&&s.add(e.setupIx),s.add(e.cancelIx)})),e.next=9,Re(s,{blockhash:i,lastValidBlockHeight:a,idl:f.xO,idlProgramId:f.Rn,skipPreflight:!0},{successMessage:(0,Z.jsx)(u.cC,{id:"Limit order closed"}),submittingMessage:(0,Z.jsx)(u.cC,{id:"Closing limit order"}),errorMessage:(0,Z.jsx)(u.cC,{id:"Failed to close order"}),referenceFee:"MEDIUM"===Ue?We.lo.m:"HIGH"===Ue?We.lo.h:"VERY_HIGH"===Ue?We.lo.vh:void 0});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[v,Re,Ue,We.lo.h,We.lo.m,We.lo.vh]),tt=(0,j.useCallback)(function(){var e=(0,o.Z)(c().mark((function e(t){var s,l,m,f,p,h,g,j,y,w,k,P,N,C,T,F,S,V,A,D,L,H;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="cancel-limit-order-toast",l=(0,Z.jsx)(Z.Fragment,{}),m=[],f=null===r||void 0===r?void 0:r.adapter.publicKey,r&&f&&n&&i&&ne&&0!==t.length){e.next=6;break}return e.abrupt("return");case 6:if(!(p=1===t.length?ne.find((function(e){return e.publicKey.equals(t[0])})):null)||!p.publicKey){e.next=32;break}if(e.prev=8,!("createdAt"in p.account)){e.next=20;break}return e.next=13,$e(f,p.publicKey);case 13:if(h=e.sent){e.next=16;break}throw new Error("Failed to create to v2 cancel order instruction");case 16:return e.next=18,et(f,[h]);case 18:e.next=22;break;case 20:return e.next=22,Xe(f,p.publicKey);case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(8),console.log(e.t0);case 27:return e.prev=27,ae(),e.finish(27);case 30:e.next=70;break;case 32:if(!(t.length>1)){e.next=70;break}return l=(0,Z.jsxs)("div",{children:[(0,Z.jsx)("p",{children:(0,Z.jsx)(u.cC,{id:"Cancelling {0} orders...",values:{0:t.length}})}),t.length>ke.TC?(0,Z.jsx)("p",{children:(0,Z.jsx)(u.cC,{id:"Due to transaction size, you may need to approve multiple transactions."})}):null]}),g=t.reduce((function(e,t){var r=null===ne||void 0===ne?void 0:ne.find((function(e){return e.publicKey.equals(t)}));return r?("createdAt"in r.account?e.ordersToCancelV2.push({order:r,orderPubkey:t}):e.ordersToCancelV1.push({order:r,orderPubkey:t}),e):e}),{ordersToCancelV1:[],ordersToCancelV2:[]}),j=g.ordersToCancelV1,y=g.ordersToCancelV2,w=(0,B.OZ)(j,ke.TC),k=(0,B.OZ)(y,ke.TC),e.next=39,Promise.all(w.map(function(){var e=(0,o.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.batchCancelOrder({owner:f,ordersPubKey:t.map((function(e){return e.orderPubkey}))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 39:return P=e.sent,e.next=42,Promise.all(k.map(function(){var e=(0,o.Z)(c().mark((function e(t){var r,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=(0,o.Z)(c().mark((function e(t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$e(f,t.orderPubkey);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return r=e.sent,n=r.filter(Boolean),i=new x.Transaction,n.forEach((function(e){e.setupIx&&i.add(e.setupIx),i.add(e.cancelIx)})),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 42:return N=e.sent.filter(Boolean),e.prev=43,O({duration:12e4,id:s,render:function(e){return(0,Z.jsx)(U.ZJ,De(De({},e),{},{title:d.ag._("Submitting transaction"),description:(0,Z.jsx)("div",{children:(0,Z.jsxs)("div",{className:"flex space-x-2 items-center",children:[(0,Z.jsx)(G.Z,{width:20,height:20}),(0,Z.jsx)("div",{children:l})]})})}))},closeOnClick:!1}),C=[],e.next=48,v.getLatestBlockhash("confirmed");case 48:for(T=e.sent,F=T.blockhash,S=T.lastValidBlockHeight,V=0,A=[].concat((0,a.Z)(P),(0,a.Z)(N));V<A.length;V++)D=A[V],C.push(new x.Transaction({feePayer:r.adapter.publicKey,blockhash:F,lastValidBlockHeight:S}).add(D));return e.next=54,i(C);case 54:return L=e.sent,e.next=57,Promise.all(L.map(function(){var e=(0,o.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.signature&&m.push(b().encode(t.signature)),e.next=3,(0,x.sendAndConfirmRawTransaction)(v,t.serialize(),{commitment:"confirmed"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 57:I(s),O({duration:5e3,title:d.ag._("Transaction submitted successfully"),description:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("p",{children:(0,Z.jsx)(u.cC,{id:"Limit order cancelled"})}),m.map((function(e,t){return(0,Z.jsx)("p",{children:(0,Z.jsx)(Q.Z,{txid:e})},t)}))]}),closeOnClick:!1,variant:U.Lb.SUCCESS}),e.next=67;break;case 61:e.prev=61,e.t1=e.catch(43),I(s),H=t.length>1?d.ag._("Failed to cancel some orders"):d.ag._("Failed to cancel order"),O({duration:5e3,title:H,description:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("p",{children:e.t1.message}),m.map((function(e,t){return(0,Z.jsx)("p",{children:(0,Z.jsx)(Q.Z,{txid:e})},t)}))]}),closeOnClick:!1,variant:U.Lb.INFO}),console.error({err:e.t1});case 67:return e.prev=67,setTimeout((function(){ae()}),2e3),e.finish(67);case 70:case"end":return e.stop()}}),e,null,[[8,24,27,30],[43,61,67,70]])})));return function(t){return e.apply(this,arguments)}}(),[r,n,i,ne,$e,et,Xe,ae,M,O,v,I]),rt=(0,j.useMemo)((function(){return!ne||0===ne.length||"Order History"===J}),[J,ne]),nt=(0,j.useCallback)((function(){if(ne&&!rt){var e=ne.map((function(e){return e.publicKey})).filter(Boolean);tt(e)}}),[rt,ne,tt]),it=(0,j.useCallback)((function(){ae(),me()}),[ae,me]),at=(0,Me.a)(["limit-order-fee-structure"],(0,o.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.JK(v);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{}),st=at.data,ot=at.isLoading,lt=(0,j.useState)({day:0,hour:0,minute:0}),ct=lt[0],ut=lt[1],dt=(0,j.useMemo)((function(){return[ct.day?"".concat(ct.day,"d"):"",ct.hour?"".concat(ct.hour,"h"):"",ct.minute?"".concat(ct.minute,"m"):""].join(" ")}),[ct]);return(0,Z.jsx)("div",{className:"w-full flex-1 flex flex-col",children:(0,Z.jsxs)("div",{className:"flex-1 flex flex-col relative h-full",children:[(0,Z.jsx)("div",{className:"w-full relative flex justify-center",children:(0,Z.jsxs)("div",{className:"flex flex-col w-full",children:[(0,Z.jsx)("div",{className:"rounded-2xl shadow-xl border-white/5 flex flex-col lg:flex-row justify-center w-full",children:(0,Z.jsx)(Ne,{fromPairTokenInfo:_,toPairTokenInfo:E,baseTokenInfo:null!==Pe&&void 0!==Pe?Pe:Le,quoteTokenInfo:null!==we&&void 0!==we?we:Le,baseTokenPrice:Fe,quoteTokenPrice:Ze,baseAndQuoteTokenPriceFetched:Ve,rateDecimals:Se,control:he,isDisabled:He,onSubmit:ve(Je),watchAllFields:Ae,setValue:ge,formState:je,isLoadingDasQuery:Ye,tokenHaveTransferFee:Qe,customDateLabel:dt,setCustomDate:ut})}),(0,Z.jsx)("div",{children:(0,Z.jsx)(Be,{rateDecimals:Se,feeStructure:{data:st,isLoading:ot},fromPairTokenInfo:_,toPairTokenInfo:E,targetPrice:Ae.targetPrice,expiry:Ae.expiry,customDateLabel:dt,fromPairValue:Ae.fromPairValue,toPairValue:Ae.toPairValue})})]})}),(0,R.mD)(e)&&e.container.leftContainerHistories&&e.container.leftContainerHistories.current&&(0,K.createPortal)((0,Z.jsxs)(z.Z,{tabs:["Open Orders","Order History"],activeTab:J,setActiveTab:X,isLoading:ie||de,cancelAllOrderDisabled:rt,cancelAllOrder:nt,refetch:it,children:["Open Orders"===J?(0,Z.jsx)(Ce.Z,{orders:le,cancelOrder:tt,ongoingSubmission:Ee,loading:ie,pageIndex:ee,setPageIndex:te,pageCount:se}):null,"Order History"===J?(0,Z.jsx)(Oe.Z,{orders:(null===ue||void 0===ue?void 0:ue.orders)||[],loading:de,pageIndex:ee,setPageIndex:te,pageCount:fe}):null]}),e.container.leftContainerHistories.current),(0,R.mD)(e)&&e.container.bottomPageHistories&&e.container.bottomPageHistories.current&&(0,K.createPortal)((0,Z.jsxs)(z.Z,{tabs:["Open Orders","Order History"],activeTab:J,setActiveTab:X,isLoading:ie||de,cancelAllOrderDisabled:rt,cancelAllOrder:nt,refetch:it,children:["Open Orders"===J?(0,Z.jsx)(Ce.Z,{orders:le,cancelOrder:tt,ongoingSubmission:Ee,loading:ie,pageIndex:ee,setPageIndex:te,pageCount:se}):null,"Order History"===J?(0,Z.jsx)(Oe.Z,{orders:(null===ue||void 0===ue?void 0:ue.orders)||[],loading:de,pageIndex:ee,setPageIndex:te,pageCount:fe}):null]}),e.container.bottomPageHistories.current)]})})},_e=function(){return(0,Z.jsx)(Ze.ZP,{children:(0,Z.jsx)(He,{})})},Ee=!0,Ke=function(){return(0,Z.jsxs)(F,{children:[(0,Z.jsx)(n.PB,{title:"Limit Order"}),(0,Z.jsx)(_e,{})]})}},60569:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/limit/[inOut]",function(){return r(34522)}])}},function(e){e.O(0,[3215,4518,5426,7783,1667,3112,1963,7240,9896,9774,2888,179],(function(){return t=60569,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=[inOut]-8d3d4f2b77f9f6f8.js.map